<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Remix Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css">

  <!-- Your CSS -->
  <link rel="stylesheet" href="assets/css/styles.css">

  <title>Login</title>
</head>
<body>

<!-- LOGIN PAGE -->
<div class="login" id="loginPage">
  <img src="assets/img/login-bg.png" class="login__bg">

  <form class="login__form" onsubmit="login(event)">
    <h1 class="login__title">Login</h1>

    <div class="login__inputs">
      <div class="login__box">
        <input id="username" placeholder="Username" class="login__input" required>
        <i class="ri-user-fill"></i>
      </div>

      <div class="login__box">
        <input id="password" type="password" placeholder="Password" class="login__input" required>
        <i class="ri-lock-2-fill"></i>
      </div>
    </div>

    <button class="login__button">Login</button>

    <div class="login__register">
      Don't have an account?
      <a href="#" onclick="register()">Register</a>
    </div>
  </form>
</div>

<!-- APP -->
<div id="app" class="hidden">

  <!-- HAMBURGER -->
  <div class="hamburger" onclick="openMenu()">☰</div>

  <!-- SIDE MENU -->
  <div class="side-menu" id="sideMenu">
    <div class="menu-header">
      <span>Menu</span>
      <span class="close-btn" onclick="closeMenu()">✖</span>
    </div>

    <a onclick="showProfile()">Profile</a>
    <a onclick="logout()">Logout</a>
  </div>

  <!-- CONTENT -->
  <div style="padding:20px;color:white">
    <h2 id="welcome"></h2>
    <p>Netherite: <span id="netherite"></span></p>
  </div>
</div>

<script>
/* ===== SESSION ===== */
const session = localStorage.getItem("session");

if (session) {
  loginPage.style.display = "none";
  app.classList.remove("hidden");
  loadUser();
}

/* ===== USERS ===== */
function getUsers() {
  return JSON.parse(localStorage.getItem("users") || "{}");
}

function saveUsers(u) {
  localStorage.setItem("users", JSON.stringify(u));
}

/* ===== REGISTER ===== */
function register() {
  const u = username.value;
  const p = password.value;

  if (p.length < 8) return alert("Password must be 8 characters");

  const users = getUsers();
  if (users[u]) return alert("User exists");

  users[u] = { password: p, netherite: 100 };
  saveUsers(users);
  alert("Registered! Now login.");
}

/* ===== LOGIN ===== */
function login(e) {
  e.preventDefault();
  const users = getUsers();

  if (!users[username.value] || users[username.value].password !== password.value) {
    alert("Wrong login");
    return;
  }

  localStorage.setItem("session", username.value);
  location.reload();
}

/* ===== LOAD USER ===== */
function loadUser() {
  const u = getUsers()[session];
  welcome.innerText = "Welcome, " + session;
  netherite.innerText = u.netherite;
}

/* ===== MENU ===== */
function openMenu() {
  sideMenu.style.left = "0";
}
function closeMenu() {
  sideMenu.style.left = "-260px";
}

/* ===== PROFILE PAGE ===== */
function showProfile() {
  window.location.href = "page.html?username=" + session;
}

/* ===== LOGOUT ===== */
function logout() {
  localStorage.removeItem("session");
  location.reload();
}
</script>

</body>
</html>
